# üß™ **–ö–û–ú–ü–õ–ï–ö–°–ù–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ PHOTER BACKEND**

> **–í–µ—Ä—Å–∏—è 1.0** - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è NestJS API —Å 90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

**–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—ç–∫–µ–Ω–¥–∞ Photer, –≤–∫–ª—é—á–∞—é—â—É—é:**

- ‚úÖ Unit —Ç–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- ‚úÖ –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (JWT, OAuth, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- ‚úÖ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ quality gates

---

## üîç **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò –ò–• –†–ï–®–ï–ù–ò–Ø**

### ‚ö†Ô∏è **–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–û—á–µ–Ω—å –Ω–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** - —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ E2E —Ç–µ—Å—Ç—ã
2. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç unit —Ç–µ—Å—Ç—ã** –¥–ª—è 90% —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
3. **–ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** —Å Prisma/PostgreSQL
4. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** JWT/OAuth flows
5. **–ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö quality gates**
6. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–π**

### üéØ **–ü–ª–∞–Ω —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è:**

```bash
# 1. –°–æ–∑–¥–∞—Ç—å Jest –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å –≤—ã—Å–æ–∫–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏
npm run test:unit

# 2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
npm run test:integration

# 3. –†–∞—Å—à–∏—Ä–∏—Ç—å E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run test:e2e

# 4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
npm run test:security

# 5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run test:load

# 6. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å quality gates
npm run quality:check
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤–∫–ª—é—á–∞—è —Ç–µ—Å—Ç–æ–≤—ã–µ)
npm install

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
npm install --save-dev @nestjs/testing @types/supertest supertest
npm install --save-dev jest-extended jest-when
npm install --save-dev artillery autocannon  # –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL="postgresql://test_user:test_password@localhost:5432/photer_test"

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
npm run prisma:migrate

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
npm run prisma:generate
```

### 3. –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

```bash
# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
npm run quality:full

# –ü–æ—ç—Ç–∞–ø–Ω—ã–π –∑–∞–ø—É—Å–∫
npm run test:unit           # Unit —Ç–µ—Å—Ç—ã (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)
npm run test:integration    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ë–î
npm run test:e2e           # E2E API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run test:security      # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
npm run test:load          # –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
npm test && npm run test:e2e:gateway
```

---

## üõ†Ô∏è **–ù–û–í–´–ï –ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–ï –ö–û–ú–ê–ù–î–´**

### üéØ Quality Gates

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º)
npm run quality:full

# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
npm run quality:check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
npm run test:critical
```

### üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

```bash
# –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –≤—ã—Å–æ–∫–∏–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º (90%+)
npm run test:unit

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –ë–î
npm run test:integration

# –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (JWT, OAuth, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
npm run test:security

# –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run test:load

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
npm run test:contracts
```

---

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### Unit —Ç–µ—Å—Ç—ã (Jest)

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
npm test

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ watch (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)
npm run test:watch

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
npm run test:cov

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
npm test -- --testNamePattern="AuthService"

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–µ
npm test apps/gateway/src/auth/

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
npm test -- --verbose

# Debug —Ä–µ–∂–∏–º
npm run test:debug
```

### E2E —Ç–µ—Å—Ç—ã (Supertest)

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö E2E —Ç–µ—Å—Ç–æ–≤
npm run test:e2e:gateway
npm run test:e2e:storage

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ E2E —Ç–µ—Å—Ç–∞
npm run test:e2e:gateway -- --testNamePattern="auth"

# Debug E2E —Ç–µ—Å—Ç–æ–≤
npm run test:e2e:debug
```

---

## üß™ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã

```bash
apps/
‚îú‚îÄ‚îÄ gateway/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.service.spec.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.controller.spec.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ strategies/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ jwt.strategy.spec.ts
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ local.strategy.spec.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ posts/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ posts.service.spec.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ posts.controller.spec.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ users.service.spec.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ users.controller.spec.ts
‚îÇ   ‚îî‚îÄ‚îÄ test/
‚îÇ       ‚îú‚îÄ‚îÄ integration/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.integration.spec.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ posts.integration.spec.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ database.integration.spec.ts
‚îÇ       ‚îú‚îÄ‚îÄ security/              # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.security.spec.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ jwt.security.spec.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ oauth.security.spec.ts
‚îÇ       ‚îî‚îÄ‚îÄ load/                  # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ           ‚îú‚îÄ‚îÄ auth.load.spec.ts
‚îÇ           ‚îî‚îÄ‚îÄ posts.load.spec.ts
```

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

```bash
test/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ test-database.util.ts      # –£—Ç–∏–ª–∏—Ç—ã —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ mock-factory.util.ts       # –§–∞–±—Ä–∏–∫–∏ –º–æ–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ test-helpers.util.ts       # –û–±—â–∏–µ –ø–æ–º–æ—â–Ω–∏–∫–∏
‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îú‚îÄ‚îÄ auth.fixtures.ts           # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ posts.fixtures.ts
‚îî‚îÄ‚îÄ mocks/
    ‚îú‚îÄ‚îÄ prisma.mock.ts            # Mock Prisma –∫–ª–∏–µ–Ω—Ç–∞
    ‚îî‚îÄ‚îÄ s3.mock.ts               # Mock AWS S3
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Jest (jest.config.js) - –û–ë–ù–û–í–õ–ï–ù–û

```javascript
module.exports = {
  moduleFileExtensions: ['js', 'json', 'ts'],
  rootDir: '.',
  testRegex: '.*\\.spec\\.ts$',
  transform: {
    '^.+\\.(t|j)s$': 'ts-jest',
  },
  collectCoverageFrom: [
    'apps/**/*.(t|j)s',
    '!apps/**/*.spec.ts',
    '!apps/**/*.e2e-spec.ts',
    '!apps/**/*.d.ts',
    '!apps/**/main.ts',
  ],
  coverageDirectory: './coverage',
  testEnvironment: 'node',
  roots: ['<rootDir>/apps/'],

  // –ù–û–í–´–ï –í–´–°–û–ö–ò–ï –°–¢–ê–ù–î–ê–†–¢–´ –ü–û–ö–†–´–¢–ò–Ø
  coverageThreshold: {
    global: {
      branches: 85,
      functions: 90,
      lines: 90,
      statements: 90,
    },
  },

  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  setupFilesAfterEnv: ['<rootDir>/test/setup.ts'],
  moduleNameMapping: {
    '^@app/(.*)$': '<rootDir>/apps/$1',
    '^@test/(.*)$': '<rootDir>/test/$1',
  },
  testTimeout: 30000,

  // –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
  reporters: [
    'default',
    ['jest-junit', {
      outputDirectory: './test-results/',
      outputName: 'junit.xml',
    }],
    ['jest-html-reporter', {
      pageTitle: 'Photer API Test Report',
      outputPath: './test-results/report.html',
    }],
  ],
};
```

### E2E –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```javascript
// apps/gateway/test/jest-e2e.json - –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø
{
  "moduleFileExtensions": ["js", "json", "ts"],
  "rootDir": ".",
  "testEnvironment": "node",
  "testRegex": ".e2e-spec.ts$",
  "transform": {
    "^.+\\.(t|j)s$": "ts-jest"
  },
  "setupFilesAfterEnv": ["<rootDir>/test/e2e-setup.ts"],
  "testTimeout": 60000,
  "globalSetup": "<rootDir>/test/global-setup.ts",
  "globalTeardown": "<rootDir>/test/global-teardown.ts"
}
```

---

## üìä **–ù–û–í–´–ï –°–¢–ê–ù–î–ê–†–¢–´ –ö–ê–ß–ï–°–¢–í–ê**

### üéØ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ú–∏–Ω–∏–º—É–º | –¶–µ–ª—å | –°—Ç–∞—Ç—É—Å |
|-----------|---------|------|--------|
| **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞** | 90% | 95% | üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ |
| **API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** | 100% | 100% | üÜï –ù–æ–≤–æ–µ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | 100% | 100% | üÜï –ù–æ–≤–æ–µ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | < 500ms | < 200ms | üÜï –ù–æ–≤–æ–µ |
| **–ù–∞–≥—Ä—É–∑–∫–∞** | 1000 RPS | 2000 RPS | üÜï –ù–æ–≤–æ–µ |

### ‚úÖ **–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ):**

#### Unit —Ç–µ—Å—Ç—ã (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)

- üÜï **AuthService** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **PostsService** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **UsersService** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **ProfileService** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **SecurityService** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **JWT Strategy** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **OAuth Strategies** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–Ω–æ–≤–æ–µ)

- üÜï **Database Integration** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Prisma Operations** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **S3 Storage Integration** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Email Service Integration** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### E2E —Ç–µ—Å—Ç—ã (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)

- üîÑ **Authentication Flow** - –†–∞—Å—à–∏—Ä—è–µ—Ç—Å—è
- üîÑ **CRUD Operations** - –†–∞—Å—à–∏—Ä—è–µ—Ç—Å—è
- üÜï **File Upload/Download** - –ù–æ–≤–æ–µ
- üÜï **OAuth Integration** - –ù–æ–≤–æ–µ

#### –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–æ–≤–æ–µ)

- üÜï **JWT Security** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **OAuth Security** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Authorization** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Input Validation** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (–Ω–æ–≤–æ–µ)

- üÜï **API Endpoints** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Database Load** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **File Upload Load** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- üÜï **Concurrent Users** - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### üö® **Quality Gates (–Ω–æ–≤–æ–µ):**

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
- ESLint –ø—Ä–æ–≤–µ—Ä–∫–∞: ‚úÖ –î–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏
- TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∞: ‚úÖ –î–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏
- Unit —Ç–µ—Å—Ç—ã: ‚úÖ > 90% –ø–æ–∫—Ä—ã—Ç–∏–µ
- Integration —Ç–µ—Å—Ç—ã: ‚úÖ 100% –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ
- Security —Ç–µ—Å—Ç—ã: ‚úÖ 100% –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ
```

---

## üéØ **–ö–û–ú–ü–õ–ï–ö–°–ù–´–ï –õ–£–ß–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò**

### 1. **–ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è NestJS**

```text
      üî∫ E2E (10%)
     üî∏üî∏ Integration (20%)
   üîπüîπüîπüîπ Unit (70%)
```

### 2. **Unit —Ç–µ—Å—Ç—ã (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)**

1. **–ò–∑–æ–ª—è—Ü–∏—è:** –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º + –º–æ–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. **AAA Pattern:** Arrange ‚Üí Act ‚Üí Assert
3. **–ü–æ–∫—Ä—ã—Ç–∏–µ:** 90%+ statements, 85%+ branches
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** < 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
5. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

```typescript
// ‚úÖ –•–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä NestJS unit —Ç–µ—Å—Ç–∞
describe('AuthService', () => {
  let service: AuthService;
  let mockPrismaService: DeepMockProxy<PrismaService>;
  let mockJwtService: DeepMockProxy<JwtService>;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [
        AuthService,
        {
          provide: PrismaService,
          useValue: mockDeep<PrismaService>(),
        },
        {
          provide: JwtService,
          useValue: mockDeep<JwtService>(),
        },
      ],
    }).compile();

    service = module.get<AuthService>(AuthService);
    mockPrismaService = module.get(PrismaService);
    mockJwtService = module.get(JwtService);
  });

  describe('login', () => {
    it('should return access token for valid credentials', async () => {
      // Arrange
      const loginDto = { email: 'test@example.com', password: 'password123' };
      const mockUser = {
        id: '1',
        email: 'test@example.com',
        hashedPassword: 'hashed_password'
      };
      mockPrismaService.user.findUnique.mockResolvedValue(mockUser);
      mockJwtService.sign.mockReturnValue('jwt_token');

      // Act
      const result = await service.login(loginDto);

      // Assert
      expect(result).toEqual({
        accessToken: 'jwt_token',
        user: expect.objectContaining({
          id: '1',
          email: 'test@example.com'
        })
      });
      expect(mockPrismaService.user.findUnique).toHaveBeenCalledWith({
        where: { email: loginDto.email }
      });
    });

    it('should throw UnauthorizedException for invalid credentials', async () => {
      // Arrange
      const loginDto = { email: 'test@example.com', password: 'wrong_password' };
      mockPrismaService.user.findUnique.mockResolvedValue(null);

      // Act & Assert
      await expect(service.login(loginDto)).rejects.toThrow(UnauthorizedException);
    });
  });
});
```

### 3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–Ω–æ–≤–æ–µ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)**

1. **Database Testing:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î
2. **Service Integration:** –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
3. **External APIs:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å S3, Email —Å–µ—Ä–≤–∏—Å–∞–º–∏
4. **Transaction Testing:** –ü—Ä–æ–≤–µ—Ä–∫–∞ ACID —Å–≤–æ–π—Å—Ç–≤

```typescript
// ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å –ë–î
describe('PostsService Integration', () => {
  let app: INestApplication;
  let prismaService: PrismaService;
  let postsService: PostsService;

  beforeAll(async () => {
    const moduleFixture: TestingModule = await Test.createTestingModule({
      imports: [AppModule],
    }).compile();

    app = moduleFixture.createNestApplication();
    await app.init();

    prismaService = app.get<PrismaService>(PrismaService);
    postsService = app.get<PostsService>(PostsService);

    // –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    await prismaService.post.deleteMany();
    await prismaService.user.deleteMany();
  });

  afterAll(async () => {
    await app.close();
  });

  describe('createPost', () => {
    it('should create post with photos and update user stats', async () => {
      // Arrange
      const testUser = await prismaService.user.create({
        data: { email: 'test@example.com', userName: 'testuser' }
      });

      const createPostDto = {
        description: 'Test post',
        photos: ['photo1.jpg', 'photo2.jpg']
      };

      // Act
      const result = await postsService.create(testUser.id, createPostDto);

      // Assert
      expect(result).toMatchObject({
        description: 'Test post',
        photos: ['photo1.jpg', 'photo2.jpg'],
        userId: testUser.id
      });

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –ë–î
      const savedPost = await prismaService.post.findUnique({
        where: { id: result.id },
        include: { user: true }
      });

      expect(savedPost).toBeDefined();
      expect(savedPost.user.postsCount).toBe(1);
    });
  });
});
```

### 4. **E2E —Ç–µ—Å—Ç—ã (—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã)**

1. **API Contract Testing:** –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
2. **Authentication Flows:** JWT, OAuth –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
3. **File Upload/Download:** S3 –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **Error Scenarios:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ edge cases

```typescript
// ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π E2E —Ç–µ—Å—Ç
describe('Authentication API (e2e)', () => {
  let app: INestApplication;

  beforeAll(async () => {
    const moduleFixture: TestingModule = await Test.createTestingModule({
      imports: [AppModule],
    }).compile();

    app = moduleFixture.createNestApplication();
    await app.init();
  });

  afterAll(async () => {
    await app.close();
  });

  describe('POST /auth/login', () => {
    it('should return access token for valid credentials', () => {
      return request(app.getHttpServer())
        .post('/auth/login')
        .send({
          email: 'test@example.com',
          password: 'password123'
        })
        .expect(200)
        .expect((res) => {
          expect(res.body).toHaveProperty('accessToken');
          expect(res.body).toHaveProperty('user');
          expect(res.body.user).toMatchObject({
            email: 'test@example.com'
          });
        });
    });

    it('should return 401 for invalid credentials', () => {
      return request(app.getHttpServer())
        .post('/auth/login')
        .send({
          email: 'test@example.com',
          password: 'wrong_password'
        })
        .expect(401)
        .expect((res) => {
          expect(res.body).toHaveProperty('message');
          expect(res.body.message).toContain('Invalid credentials');
        });
    });
  });

  describe('Protected Routes', () => {
    let accessToken: string;

    beforeAll(async () => {
      // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Ä–æ—É—Ç–æ–≤
      const response = await request(app.getHttpServer())
        .post('/auth/login')
        .send({
          email: 'test@example.com',
          password: 'password123'
        });

      accessToken = response.body.accessToken;
    });

    it('should access protected route with valid token', () => {
      return request(app.getHttpServer())
        .get('/auth/me')
        .set('Authorization', `Bearer ${accessToken}`)
        .expect(200)
        .expect((res) => {
          expect(res.body).toHaveProperty('id');
          expect(res.body).toHaveProperty('email');
        });
    });

    it('should reject access without token', () => {
      return request(app.getHttpServer())
        .get('/auth/me')
        .expect(401);
    });
  });
});
```

### 5. **–¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–æ–≤–æ–µ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)**

1. **JWT Security:** –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤, –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏
2. **OAuth Security:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. **Input Validation:** SQL injection, XSS prevention
4. **Authorization:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### 6. **–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–æ–≤–æ–µ)**

1. **API Load Testing:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
2. **Database Performance:** –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
3. **Concurrent Users:** –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
4. **Memory/CPU Usage:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

### 7. **Quality Gates (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)**

1. **Pre-commit hooks:** ESLint + TypeScript + unit —Ç–µ—Å—Ç—ã
2. **CI/CD Pipeline:** –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥—ã–π PR
3. **Code Coverage:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ PR –ø—Ä–∏ –ø–æ–∫—Ä—ã—Ç–∏–∏ < 90%
4. **Performance Budget:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

---

## üõ°Ô∏è **–°–¢–†–ê–¢–ï–ì–ò–Ø –ü–†–ï–î–û–¢–í–†–ê–©–ï–ù–ò–Ø –†–ï–ì–†–ï–°–°–ò–ô**

### üö® **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π:**

#### 1. **–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
npm run quality:full
```

#### 2. **–í–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (TDD –ø–æ–¥—Ö–æ–¥):**

```bash
# 1. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç
describe('NewService', () => {
  it('should do something', () => {
    // Arrange, Act, Assert
  });
});

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç (–¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è)
npm run test:watch

# 3. –ù–∞–ø–∏—à–∏—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥
# 4. –¢–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏
# 5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

#### 3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:**

- ‚úÖ **Unit —Ç–µ—Å—Ç—ã** - –ª–æ–≥–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- ‚úÖ **Integration —Ç–µ—Å—Ç—ã** - –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ë–î –∏ –≤–Ω–µ—à–Ω–∏–º–∏ API
- ‚úÖ **E2E —Ç–µ—Å—Ç—ã** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API endpoints
- ‚úÖ **Security —Ç–µ—Å—Ç—ã** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ **Performance —Ç–µ—Å—Ç—ã** - –µ—Å–ª–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### 4. **–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):**

```bash
# –•—É–∫–∏ Git –∑–∞–ø—É—Å—Ç—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ESLint –ø—Ä–æ–≤–µ—Ä–∫–∞
- TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∞
- Unit —Ç–µ—Å—Ç—ã (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
```

#### 5. **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Pull Request:**

```bash
# CI/CD –∑–∞–ø—É—Å—Ç–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä:
npm run quality:full
npm run test:security
npm run test:load
npm run build
```

### üîÑ **Continuous Integration Quality Gates:**

| –≠—Ç–∞–ø | –ü—Ä–æ–≤–µ—Ä–∫–∏ | –ö—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è |
|------|----------|----------------------|
| **Pre-commit** | Lint + Types + Unit | ‚úÖ –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç |
| **PR Created** | Full Quality Suite | ‚úÖ 95% —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç |
| **Before Merge** | Security + Load + Performance | ‚úÖ 100% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö |
| **After Merge** | Regression Suite | ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ |

### üéØ **–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```bash
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ - –ø–æ–ª–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
npm run test:regression:full

# –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ª–∏–∑–∞ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
npm run test:regression:critical

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
npm run test:performance:monitor
```

---

## üîß **–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò**

### ‚úÖ **Package.json - –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:**

```json
{
  "scripts": {
    "test:unit": "jest --coverage --watchAll=false",
    "test:integration": "jest --config jest-integration.config.js",
    "test:security": "jest --testPathPatterns=\"security\"",
    "test:load": "artillery run test/load/api-load.yml",
    "test:contracts": "jest --testPathPatterns=\"contracts\"",
    "quality:check": "npm run lint && npm run test:unit && npm run test:integration",
    "quality:full": "npm run quality:check && npm run test:e2e:gateway && npm run test:security",
    "test:critical": "jest --testPathPatterns=\"critical\""
  }
}
```

### ‚úÖ **–ù–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:**

- `test/utils/test-database.util.ts` - –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
- `test/utils/mock-factory.util.ts` - –§–∞–±—Ä–∏–∫–∏ –º–æ–∫–æ–≤
- `test/security/jwt.security.spec.ts` - –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ JWT
- `test/load/api-load.yml` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

## ü§ù –í–∫–ª–∞–¥ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–ù–æ–≤—ã–π workflow –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**

1. **üìù –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
2. **üß™ TDD —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** - —Ç–µ—Å—Ç—ã ‚Üí –∫–æ–¥ ‚Üí —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
3. **üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞** - `npm run quality:full`
4. **üìä –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è** - —É–±–µ–¥–∏—Ç–µ—Å—å –≤ 90%+ –ø–æ–∫—Ä—ã—Ç–∏–∏
5. **üöÄ Deployment** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ CI/CD

---

## üìö **–û–ë–ù–û–í–õ–ï–ù–ù–´–ï –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò**

### üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- [NestJS Testing](https://docs.nestjs.com/fundamentals/testing) - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Jest Documentation](https://jestjs.io/docs/getting-started) - Unit —Ç–µ—Å—Ç—ã
- [Supertest](https://github.com/ladjs/supertest) - HTTP —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [Prisma Testing](https://www.prisma.io/docs/guides/testing) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î

### üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–æ–≤–æ–µ):**

- [NestJS Security](https://docs.nestjs.com/security/authentication) - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [JWT Best Practices](https://tools.ietf.org/rfc/rfc8725.txt) - JWT –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [OWASP API Security](https://owasp.org/www-project-api-security/) - API –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–æ–≤–æ–µ):**

- [Artillery](https://artillery.io/) - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [Autocannon](https://github.com/mcollina/autocannon) - HTTP benchmarking
- [Node.js Performance](https://nodejs.org/en/docs/guides/simple-profiling/) - –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### üîó **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–Ω–æ–≤–æ–µ):**

- [Prisma Testing Guide](https://www.prisma.io/docs/guides/testing) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- [AWS S3 Testing](https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/tests-unit-mock.html) - Mock AWS —Å–µ—Ä–≤–∏—Å–æ–≤
- [NestJS E2E Testing](https://docs.nestjs.com/fundamentals/testing#end-to-end-testing) - E2E —Ç–µ—Å—Ç—ã

### üõ†Ô∏è **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞:**

- [ESLint NestJS](https://github.com/darraghor/eslint-plugin-nestjs-typed) - –õ–∏–Ω—Ç–∏–Ω–≥ NestJS
- [Jest Extended](https://github.com/jest-community/jest-extended) - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç—á–µ—Ä—ã
- [TypeScript ESLint](https://typescript-eslint.io/) - TypeScript –ª–∏–Ω—Ç–∏–Ω–≥

---

## üöÄ **–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ü–†–û–î–ê–ö–®–ï–ù–£ 1.0**

### **–í–µ—Ä—Å–∏—è:** 1.0.0 - "Enterprise Testing Excellence"

### **–î–∞—Ç–∞:** 2025-09-25

### **–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í –ö –†–ê–ó–†–ê–ë–û–¢–ö–ï**

### üéØ **–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–µ–µ | –¶–µ–ª—å | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|---------|------|-----------|
| **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** | ~20% | 90%+ | +350% |
| **Quality Gates** | ‚ùå –ù–µ—Ç | ‚úÖ –ï—Å—Ç—å | +‚àû |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤** | ‚ùå –ù–µ—Ç | ‚úÖ 100% | +‚àû |
| **–¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤** | 1 | 6 | +600% |
| **API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** | ‚ùå –ù–µ—Ç | ‚úÖ 100% | +‚àû |
| **–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã** | ‚ùå –ù–µ—Ç | ‚úÖ –ï—Å—Ç—å | +‚àû |
| **CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | –ë–∞–∑–æ–≤–∞—è | –ü–æ–ª–Ω–∞—è | +100% |

### üõ°Ô∏è **–ì–∞—Ä–∞–Ω—Ç–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞:**

- ‚úÖ **90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–∏
- ‚úÖ **100% API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** - –≤—Å–µ endpoints –ø–æ–∫—Ä—ã—Ç—ã E2E —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ **JWT/OAuth –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ **< 500ms API response** - –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ quality gates** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–π
- ‚úÖ **Database integrity** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ **Load testing up to 1000 RPS** - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤—ã—Å–æ–∫–∏–º –Ω–∞–≥—Ä—É–∑–∫–∞–º

### üîÑ **–ü—Ä–æ—Ü–µ—Å—Å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞:**

```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω–æ (—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏)
npm run quality:check

# –ü—Ä–∏ –∫–∞–∂–¥–æ–º PR (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
npm run quality:full

# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ (—Ä–µ–≥—Ä–µ—Å—Å–∏—è)
npm run test:regression:full

# –ü—Ä–∏ —Ä–µ–ª–∏–∑–µ (–ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
npm run test:production:ready
```

### üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞:**

- **Dashboard:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **Alerts:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ø–æ–∫—Ä—ã—Ç–∏—è < 90%
- **Reports:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –æ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–¥–∞
- **Trends:** –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ –∏ —É–ª—É—á—à–µ–Ω–∏–π

---

**üéâ –†–ï–ó–£–õ–¨–¢–ê–¢:** –ë—ç–∫–µ–Ω–¥ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è enterprise —É—Ä–æ–≤–Ω—è, –∫–æ—Ç–æ—Ä–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—ã—Å–æ–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∫–∞—á–µ—Å—Ç–≤–∞ 90%+.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢–µ—Å—Ç—ã —è–≤–ª—è—é—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º 90%+. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å API.
